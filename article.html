<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>عرض المقال - AlphaKnow</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/performance.css">
    <link rel="stylesheet" href="css/navbar-fix.css">
    <style>
        .article-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .article-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f0f0f0;
        }
        .article-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1a365d;
            margin-bottom: 1rem;
        }
        .article-meta {
            display: flex;
            justify-content: center;
            gap: 2rem;
            color: #666;
            font-size: 0.9rem;
        }
        .article-content {
            line-height: 1.8;
            font-size: 1.1rem;
            color: #333;
        }
        .article-content h1, .article-content h2, .article-content h3 {
            color: #1a365d;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .article-content p {
            margin-bottom: 1rem;
        }
        .back-button {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin-bottom: 2rem;
        }
        .back-button:hover {
            background: #0056b3;
        }
        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #666;
        }
        .error {
            text-align: center;
            padding: 2rem;
            color: #dc3545;
            background: #f8d7da;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <nav class="navbar">
            <div class="container">
                <div class="navbar-brand">
                    <a href="index.html" class="logo">
                        <img src="images/logo.png" alt="AlphaKnow Logo" class="logo-img">
                        <span class="logo-text">AlphaKnow</span>
                    </a>
                </div>
                
                <div class="navbar-menu" id="navbar-menu">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">الرئيسية</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle">المقالات</a>
                            <div class="dropdown-menu">
                                <a href="category.html?cat=entrepreneurship" class="dropdown-item">ريادة الأعمال</a>
                                <a href="category.html?cat=ecommerce" class="dropdown-item">التجارة الإلكترونية</a>
                                <a href="category.html?cat=marketing" class="dropdown-item">التسويق الرقمي</a>
                                <a href="category.html?cat=freelancing" class="dropdown-item">العمل الحر</a>
                                <a href="category.html?cat=investment" class="dropdown-item">الاستثمار الرقمي</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="courses.html" class="nav-link">الدورات</a>
                        </li>
                        <li class="nav-item">
                            <a href="tools.html" class="nav-link">الأدوات</a>
                        </li>
                        <li class="nav-item">
                            <a href="about.html" class="nav-link">من نحن</a>
                        </li>
                        <li class="nav-item">
                            <a href="contact.html" class="nav-link">تواصل معنا</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a href="#" class="nav-link dropdown-toggle">المزيد</a>
                            <div class="dropdown-menu">
                                <a href="privacy.html" class="dropdown-item">سياسة الخصوصية</a>
                                <a href="terms.html" class="dropdown-item">شروط الاستخدام</a>
                                <a href="faq.html" class="dropdown-item">الأسئلة الشائعة</a>
                                <a href="sitemap.html" class="dropdown-item">خريطة الموقع</a>
                            </div>
                        </li>
                    </ul>
                </div>
                
                <div class="navbar-actions">
                    <button class="search-toggle" id="search-toggle" aria-label="البحث">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </button>
                    <button class="theme-toggle" id="theme-toggle" aria-label="تبديل الوضع">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="القائمة">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="article-container">
            <a href="index.html" class="back-button">← العودة للرئيسية</a>
        
        <div id="loading" class="loading">
            جاري تحميل المقال...
        </div>
        
        <div id="error" class="error" style="display: none;">
            المقال غير موجود أو حدث خطأ في التحميل
        </div>
        
        <article id="article-content" style="display: none;">
            <div class="article-header">
                <h1 id="article-title" class="article-title"></h1>
                <div class="article-meta">
                    <span id="article-author"></span>
                    <span id="article-date"></span>
                    <span id="article-category"></span>
                </div>
            </div>
            <div id="article-body" class="article-content"></div>
        </article>
    </div>
    </main>

    <!-- Search Overlay -->
    <div class="search-overlay" id="search-overlay">
        <div class="search-overlay-content">
            <div class="search-overlay-header">
                <h3>البحث في الموقع</h3>
                <button class="search-close" id="search-close" aria-label="إغلاق البحث">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="search-overlay-body">
                <form class="search-form" role="search">
                    <div class="search-input-group">
                        <input type="search" id="search-input" class="search-input" placeholder="ابحث في المقالات والمواضيع..." aria-label="البحث">
                        <button type="submit" class="search-submit" aria-label="البحث">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                        </button>
                    </div>
                </form>
                <div class="search-results" id="search-results">
                    <!-- Search results will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-brand">
                        <img src="images/logo.png" alt="AlphaKnow" width="40" height="40">
                        <span class="brand-text">AlphaKnow</span>
                    </div>
                    <p class="footer-description">
                        المدونة الرائدة في ريادة الأعمال الرقمية. نقدم محتوى حصري واستراتيجيات مجربة لتحقيق النجاح في العالم الرقمي.
                    </p>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-title">روابط سريعة</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">الرئيسية</a></li>
                        <li><a href="articles.html">المقالات</a></li>
                        <li><a href="courses.html">الدورات</a></li>
                        <li><a href="tools.html">الأدوات</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4 class="footer-title">تواصل معنا</h4>
                    <ul class="footer-links">
                        <li><a href="about.html">من نحن</a></li>
                        <li><a href="contact.html">تواصل معنا</a></li>
                        <li><a href="privacy.html">سياسة الخصوصية</a></li>
                        <li><a href="terms.html">شروط الاستخدام</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 AlphaKnow. جميع الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="js/firebase-config.js"></script>
    <script src="js/firebase-service.js"></script>

    <script>
        // Initialize navbar functionality
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🔧 Initializing navbar functionality...');
            
            // Mobile menu toggle
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const navbarMenu = document.getElementById('navbar-menu');
            
            console.log('📱 Mobile menu elements:', { mobileMenuToggle, navbarMenu });
            
            if (mobileMenuToggle && navbarMenu) {
                mobileMenuToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('📱 Mobile menu clicked');
                    navbarMenu.classList.toggle('active');
                    mobileMenuToggle.classList.toggle('active');
                    document.body.classList.toggle('menu-open');
                });
            }
            
            // Search functionality
            const searchToggle = document.getElementById('search-toggle');
            const searchOverlay = document.getElementById('search-overlay');
            const searchClose = document.getElementById('search-close');
            
            console.log('🔍 Search elements:', { searchToggle, searchOverlay, searchClose });
            
            if (searchToggle) {
                searchToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🔍 Search clicked');
                    if (searchOverlay) {
                        searchOverlay.classList.add('active');
                        document.getElementById('search-input')?.focus();
                    }
                });
            }
            
            if (searchClose) {
                searchClose.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('❌ Search close clicked');
                    if (searchOverlay) {
                        searchOverlay.classList.remove('active');
                    }
                });
            }
            
            // Dropdown functionality
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
            console.log('📋 Dropdown toggles found:', dropdownToggles.length);
            
            dropdownToggles.forEach((toggle, index) => {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log(`📋 Dropdown ${index + 1} clicked`);
                    
                    const dropdown = this.closest('.dropdown');
                    const isOpen = dropdown.classList.contains('open');
                    
                    // Close all other dropdowns
                    document.querySelectorAll('.dropdown.open').forEach(d => {
                        if (d !== dropdown) {
                            d.classList.remove('open');
                        }
                    });
                    
                    // Toggle current dropdown
                    dropdown.classList.toggle('open');
                    
                    // Update aria-expanded
                    this.setAttribute('aria-expanded', !isOpen);
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.dropdown')) {
                    document.querySelectorAll('.dropdown.open').forEach(dropdown => {
                        dropdown.classList.remove('open');
                    });
                }
            });
            
            // Theme toggle
            const themeToggle = document.getElementById('theme-toggle');
            console.log('🌙 Theme toggle element:', themeToggle);
            
            if (themeToggle) {
                themeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🌙 Theme toggle clicked');
                    document.body.classList.toggle('dark-theme');
                    const isDark = document.body.classList.contains('dark-theme');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                });
                
                // Load saved theme
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-theme');
                }
            }
            
            console.log('✅ Navbar functionality initialized successfully');
        });
    </script>
    
    <script>
        // Get article ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const articleId = urlParams.get('id');
        
        const loadingElement = document.getElementById('loading');
        const errorElement = document.getElementById('error');
        const articleElement = document.getElementById('article-content');
        
        async function loadArticle() {
            if (!articleId) {
                showError('معرف المقال غير محدد');
                return;
            }
            
            try {
                console.log('📚 Loading article:', articleId);
                
                if (!window.firebaseService) {
                    showError('خدمة Firebase غير متاحة');
                    return;
                }
                
                // Try to get article from Firebase
                const result = await window.firebaseService.getArticle(articleId);
                
                if (result.success && result.data) {
                    displayArticle(result.data);
                } else {
                    showError('المقال غير موجود');
                }
                
            } catch (error) {
                console.error('Error loading article:', error);
                showError('حدث خطأ أثناء تحميل المقال');
            }
        }
        
        function displayArticle(article) {
            console.log('📄 Displaying article:', article);
            
            // Set title
            document.title = article.title + ' - AlphaKnow';
            document.getElementById('article-title').textContent = article.title;
            
            // Set meta information
            document.getElementById('article-author').textContent = 'الكاتب: ' + (article.author || 'المدير');
            document.getElementById('article-date').textContent = 'التاريخ: ' + formatDate(article.createdAt || article.date);
            document.getElementById('article-category').textContent = 'الفئة: ' + getCategoryName(article.category);
            
            // Set content
            document.getElementById('article-body').innerHTML = article.content;
            
            // Hide loading, show article
            loadingElement.style.display = 'none';
            articleElement.style.display = 'block';
        }
        
        function showError(message) {
            loadingElement.style.display = 'none';
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }
        
        function formatDate(dateString) {
            if (!dateString) return 'غير محدد';
            
            try {
                if (dateString && typeof dateString === 'object' && dateString.toDate) {
                    const date = dateString.toDate();
                    return date.toLocaleDateString('ar-SA');
                }
                const date = new Date(dateString);
                if (isNaN(date.getTime())) {
                    return 'غير محدد';
                }
                return date.toLocaleDateString('ar-SA');
            } catch (error) {
                return 'غير محدد';
            }
        }
        
        function getCategoryName(categoryId) {
            const categories = {
                'entrepreneurship': 'ريادة الأعمال',
                'ecommerce': 'التجارة الإلكترونية',
                'marketing': 'التسويق الرقمي',
                'tools': 'الأدوات والموارد',
                'technology': 'التكنولوجيا'
            };
            return categories[categoryId] || categoryId;
        }
        
        // Load article when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(loadArticle, 1000);
        });
    </script>
</body>
</html>
